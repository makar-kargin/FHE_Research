# Определение ботнета Mirai в IoT-трафике с использованием машинного обучения

Данный репозиторий содержит код для детектирования атак ботнета Mirai в IoT-трафике с помощью методов машинного обучения, в частности Random Forest, с последующим анализом важности признаков с использованием SHAP (SHapley Additive exPlanations).

## Описание проекта

Проект предназначен для классификации сетевого трафика с целью выявления атак ботнета Mirai среди различных типов трафика в сетях IoT. Код включает в себя полный пайплайн обработки данных, обучения модели и её анализа.

### Функциональность

- Загрузка и предварительная обработка датасета сетевого трафика
- Создание бинарного классификатора для определения атак Mirai
- Обучение модели машинного обучения (Random Forest)
- Оценка качества модели с использованием метрик классификации
- Анализ важности признаков
- Углубленный анализ работы модели с использованием SHAP

## Датасет

В работе используется датасет `IoT_Intrusion.csv`, содержащий характеристики сетевого трафика. Атаки Mirai в данном наборе представлены тремя типами:
- Mirai-greeth_flood
- Mirai-udpplain
- Mirai-greip_flood

## Архитектура решения

1. **Предобработка данных**:
   - Удаление пропущенных значений
   - Создание бинарных и многоклассовых меток
   - Масштабирование числовых признаков

2. **Обучение модели**:
   - Разделение данных на обучающую и тестовую выборки с сохранением соотношения классов
   - Обучение классификатора Random Forest для бинарной задачи

3. **Оценка результатов**:
   - Вывод метрик качества (точность, полнота, F1-мера)
   - Построение матрицы ошибок
   - Анализ важности признаков

4. **Интерпретация модели**:
   - Использование SHAP для объяснения предсказаний модели
   - Анализ влияния отдельных признаков на решение модели

## Результаты

Модель демонстрирует высокую точность в обнаружении атак Mirai (практически 100% на тестовой выборке). Наиболее важными признаками для определения атак Mirai являются:

- Наиболее значимые признаки отображаются в виде гистограммы в порядке убывания важности
- SHAP-анализ позволяет увидеть, как конкретные признаки влияют на классификацию в каждом отдельном случае

## Используемые технологии

- **Python 3.x**
- **Pandas & NumPy**: обработка данных
- **Scikit-learn**: машинное обучение
- **Matplotlib & Seaborn**: визуализация данных
- **SHAP**: интерпретация моделей машинного обучения

## Как использовать

1. Клонировать репозиторий
2. Установить необходимые зависимости:
   ```
   pip install pandas numpy matplotlib seaborn scikit-learn shap
   ```
3. Разместить файл `IoT_Intrusion.csv` в соответствующей директории или обновить путь в коде
4. Запустить ноутбук или Python-скрипт

## Структура кода

- Импорт библиотек и настройка отображения
- Загрузка и первичный анализ данных
- Исследование распределения типов атак Mirai
- Подготовка данных для обучения модели
- Обучение классификатора Random Forest
- Оценка качества модели на тестовой выборке
- Анализ важности признаков
- Глубокий анализ работы модели с помощью SHAP

## Возможные улучшения

- Использование гиперпараметрической оптимизации для улучшения модели
- Применение других алгоритмов машинного обучения и сравнение их эффективности
- Добавление методов обнаружения аномалий для выявления новых типов атак
- Внедрение обучения с частичным привлечением учителя для работы с нечеткими метками

---

*Примечание*: Этот проект является частью исследования по обнаружению атак ботнета Mirai в сетях Интернета вещей (IoT) и может быть использован для образовательных целей и практического применения в области информационной безопасности.
